<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.65">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">Architecture | idb</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Architecture | idb"><meta data-react-helmet="true" name="description" content="idb is formed of two components that have different responsibilities. Both these components are necessary for idb to run commands."><meta data-react-helmet="true" property="og:description" content="idb is formed of two components that have different responsibilities. Both these components are necessary for idb to run commands."><meta data-react-helmet="true" property="og:url" content="https://fbidb.io/docs/architecture"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://fbidb.io/docs/architecture"><link rel="stylesheet" href="/styles.e1a7ca4d.css">
<link rel="preload" href="/styles.8855d084.js" as="script">
<link rel="preload" href="/runtime~main.6baf2278.js" as="script">
<link rel="preload" href="/main.211ca30e.js" as="script">
<link rel="preload" href="/1.80f57ca0.js" as="script">
<link rel="preload" href="/2.a5760fe5.js" as="script">
<link rel="preload" href="/15.e713a5a2.js" as="script">
<link rel="preload" href="/16.44423976.js" as="script">
<link rel="preload" href="/935f2afb.82d4b763.js" as="script">
<link rel="preload" href="/17896441.2f9e69da.js" as="script">
<link rel="preload" href="/fd532226.6380b0b3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><strong class="navbar__title">idb</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/overview">Getting Started</a><a class="navbar__item navbar__link" href="/docs/installation">Docs</a><a href="https://github.com/facebook/idb" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><strong class="navbar__title">idb</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/overview">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/installation">Docs</a></li><li class="menu__list-item"><a href="https://github.com/facebook/idb" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/guided-tour">Guided Tour</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/docs/architecture">Architecture</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/commands">Commands</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/test-execution">Test Execution</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/accessibility">Accessibility Automation</a></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Architecture</h1></header><div class="markdown"><p><code>idb</code> is formed of two components that have different responsibilities. Both these components are necessary for <code>idb</code> to run commands.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="the-idb-cli"></a>The <code>idb</code> cli<a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-idb-cli" title="Direct link to heading">#</a></h2><p>This is a python3 cli that exposes all of the functionality that idb has to offer. As it is written in Python, this does not need to be run from the Mac to which your iPhone or iOS Simulator is attached.</p><p>The cli itself is a thin wrapper for a client of the <code>idb_companion</code>. All communication to the <code>idb_companion</code> is done via <code>gRPC</code>. This can be either through TCP or a Unix Domain Socket.</p><p>This client library can be imported into your own python3 code if you wish, or the CLI can be called from any other kind of automation.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="the-idb_companion"></a>The <code>idb_companion</code><a aria-hidden="true" tabindex="-1" class="hash-link" href="#the-idb_companion" title="Direct link to heading">#</a></h2><p>The <code>idb_companion</code> is a <code>gRPC</code> server in Objective-C++ that runs on macOS. It talks to the native APIs that are used for automating Simulators and Devices. It links the <code>FBSimulatorControl</code> and <code>FBDeviceControl</code> Frameworks, which are part of the overall <code>idb</code> project.</p><p>When the <code>idb_companion</code> acts as <code>gRPC</code> server, it does so for a <em>single</em> iOS target (a device or simulator).</p><p>Additionally, the <code>idb_companion</code> has some commands that are deliberately unavailable from the python CLI, these operations are related to iOS Device management or operations on the lifecycle of a Simulator.</p><img alt="idb architecture" src="/img/idb_architecture.png"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="connections"></a>Connections<a aria-hidden="true" tabindex="-1" class="hash-link" href="#connections" title="Direct link to heading">#</a></h2><p>The <code>idb</code> cli will, by default operate in one of two modes:</p><ul><li>If the <code>idb</code> cli is running on macOS, then it will automatically start and stop companions for all targets that are attached to your Mac. This means that you can run commands against any iOS Simulators that you have, as well as any devies that you have connected.</li><li>If the <code>idb</code> cli is running on any other OS, it will not manage companions for you. In this case you can either &quot;attach&quot; companions via <code>idb connect</code> or explictly on every call using the <code>IDB_COMPANION=hostname:port</code> environment variable. This allows you to perform <code>idb</code> commands against companions running on other hosts. These facilities for companion discovery work on macOS also.</li></ul></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/guided-tour"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Guided Tour</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/commands"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Commands Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-idb-cli" class="table-of-contents__link">The <code>idb</code> cli</a></li><li><a href="#the-idb_companion" class="table-of-contents__link">The <code>idb_companion</code></a></li><li><a href="#connections" class="table-of-contents__link">Connections</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/fbOpenSource" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Contribute</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/facebook/idb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li></ul></div></div><div class="text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com/" target="_blank" rel="noopener noreferrer" class="footerLogoLink_1zJy"><img class="footer__logo" alt="idb" src="/img/oss_logo.png"></a></div><div>Copyright Â© 2020 Facebook, Inc.</div></div></div></footer></div>
<script src="/styles.8855d084.js"></script>
<script src="/runtime~main.6baf2278.js"></script>
<script src="/main.211ca30e.js"></script>
<script src="/1.80f57ca0.js"></script>
<script src="/2.a5760fe5.js"></script>
<script src="/15.e713a5a2.js"></script>
<script src="/16.44423976.js"></script>
<script src="/935f2afb.82d4b763.js"></script>
<script src="/17896441.2f9e69da.js"></script>
<script src="/fd532226.6380b0b3.js"></script>
</body>
</html>